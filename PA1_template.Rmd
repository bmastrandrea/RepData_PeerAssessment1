---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
Loading the Data, after I have downloaded and unzipped the file in my work directory

```{r}
library(ggplot2)
library(plyr)
activity <- read.csv("activity.csv")
```

Processing the Data

```{r}
activity$day <- weekdays(as.Date(activity$date))
activity$DateTime<- as.POSIXct(activity$date, format="%Y-%m-%d")

##pulling data without nas
clean <- activity[!is.na(activity$steps),]
```

## What is mean total number of steps taken per day?
Calculate the total number of steps taken per day

```{r}
## summarizing total steps per date
sumTable <- aggregate(activity$steps ~ activity$date, FUN=sum, )
colnames(sumTable)<- c("Date", "Steps")
```

Create a histogram of the total number of steps taken each day
```{r histogramm, fig.height= 5}
## Creating the historgram of total steps per day
par(mar = c(5,4,1,1), las=1)
hist(sumTable$Steps, breaks=30, xlab="Steps per Day", ylab="Frequency", main = "Histogram of Daily Steps",  col="blue", lwd=1)
```
Calculate and report the mean and median of the total number of steps taken per day

```{r}
## Mean of Steps
as.integer(mean(sumTable$Steps))
## [1] 10766
```
The average number of steps taken each day was 10766 steps.

```{r}
## Median of Steps
as.integer(median(sumTable$Steps))
## [1] 10765
```
The median number of steps taken each day was 10765 steps.

## What is the average daily activity pattern?

Now I will create the time series plot (i.e. type = “l”) of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis).

```{r}
library(plyr)
library(ggplot2)
##pulling data without nas
clean <- activity[!is.na(activity$steps),]

##create average number of steps per interval
intervalTable <- ddply(clean, .(interval), summarize, Avg = mean(steps))

##Create line plot of average number of steps per interval
p <- ggplot(intervalTable, aes(x=interval, y=Avg), xlab = "Interval", ylab="Average Number of Steps")
p + geom_line()+xlab("Interval")+ylab("Average Number of Steps")+ggtitle("Average Number of Steps per Interval")
```
Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?

```{r}
##Maximum steps by interval
maxSteps <- max(intervalTable$Avg)
##Which interval contains the maximum average number of steps
intervalTable[intervalTable$Avg==maxSteps,1]
## [1] 835
```

The maximum number of steps for a 5-minute interval was 206 steps.

The 5-minute interval which had the maximum number of steps was the 835 interval.

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
